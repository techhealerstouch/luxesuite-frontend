(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[998],{3495:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(5155),a=t(2115),i=t(5695),l=t(5499),n=t(6639),o=t(8054),d=t(8482),c=t(9852),u=t(8749),m=t(2657);function p(e){let{userDetails:s,setUserDetails:t}=e,[i,l]=(0,a.useState)(!1),[n,o]=(0,a.useState)(!1),p="w-5 h-5 text-gray-500 hover:text-gray-700 transition-colors";return(0,r.jsxs)(d.Zp,{children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"User Details"}),(0,r.jsx)(d.BT,{children:"Enter user information"})]}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium text-gray-700",children:"Name"}),(0,r.jsx)(c.p,{placeholder:"Full Name",value:s.name,onChange:e=>t({...s,name:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium text-gray-700",children:"Email"}),(0,r.jsx)(c.p,{type:"email",placeholder:"Email",value:s.email,onChange:e=>t({...s,email:e.target.value})})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium text-gray-700",children:"Password"}),(0,r.jsxs)("div",{className:"flex items-center relative",children:[(0,r.jsx)(c.p,{type:i?"text":"password",placeholder:"Password",className:"pr-10",value:s.password,onChange:e=>t({...s,password:e.target.value})}),(0,r.jsx)("button",{type:"button",className:"absolute right-2",onClick:()=>l(!i),children:i?(0,r.jsx)(u.A,{className:p}):(0,r.jsx)(m.A,{className:p})})]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium text-gray-700",children:"Confirm Password"}),(0,r.jsxs)("div",{className:"flex items-center relative",children:[(0,r.jsx)(c.p,{type:n?"text":"password",placeholder:"Confirm Password",className:"pr-10",value:s.confirmPassword,onChange:e=>t({...s,confirmPassword:e.target.value})}),(0,r.jsx)("button",{type:"button",className:"absolute right-2",onClick:()=>o(!n),children:n?(0,r.jsx)(u.A,{className:p}):(0,r.jsx)(m.A,{className:p})})]})]})]})]})}var h=t(9613);function x(e){let{permissions:s,setPermissions:t}=e,[i,l]=(0,a.useState)([]);(0,a.useEffect)(()=>{o.K.getAllPermissions().then(e=>{l(e);let r={};e.forEach(e=>{e.name in s?r[e.name]=s[e.name]:r[e.name]=!1}),t(r)})},[]);let n=e=>{t({...s,[e]:!s[e]})},c={};i.forEach(e=>{c[e.category]||(c[e.category]=[]),c[e.category].push(e)});let u={view_products:"Allows the user to view products",create_products:"Allows the user to create new products",edit_products:"Allows the user to edit existing products",delete_products:"Allows the user to delete products",view_brands:"Allows the user to view brands",create_brands:"Allows the user to create new brands",edit_brands:"Allows the user to edit existing brands",delete_brands:"Allows the user to delete brands",view_item_types:"Allows the user to view item types",create_item_types:"Allows the user to create item types",edit_item_types:"Allows the user to edit item types",delete_item_types:"Allows the user to delete item types"},m={products:"Give permissions for product module",brands:"Give permissions for brand module","item types":"Give permissions for item type module",general:"General permissions"};return(0,r.jsx)(h.Kq,{children:(0,r.jsxs)(d.Zp,{children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"Permissions"}),(0,r.jsx)(d.BT,{children:"Assign permissions to this user"})]}),(0,r.jsx)(d.Wu,{className:"space-y-6",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(c).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-semibold",children:t.charAt(0).toUpperCase()+t.slice(1)}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:m[t.toLowerCase()]||"Assign permissions for this module"}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:a.map(e=>(0,r.jsxs)(h.bL,{children:[(0,r.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:s[e.name]||!1,onChange:()=>n(e.name)}),(0,r.jsx)(h.l9,{asChild:!0,children:(0,r.jsx)("span",{className:"no-underline",children:e.label})})]}),(0,r.jsx)(h.ZL,{children:(0,r.jsxs)(h.UC,{side:"top",align:"center",sideOffset:4,className:"bg-gray-800 text-white text-sm rounded px-2 py-1 shadow-lg z-50",children:[u[e.name]||e.label,(0,r.jsx)(h.i3,{className:"fill-gray-800",offset:10})]})})]},e.name))})]},t)})})})]})})}var f=t(7168),j=t(3580),b=t(1154);function g(){let e=(0,i.useRouter)(),{toast:s}=(0,j.dj)(),[t,c]=(0,a.useState)({name:"",email:"",password:"",confirmPassword:""}),[u,m]=(0,a.useState)({}),[h,g]=(0,a.useState)(!1),w=async()=>{if(t.password!==t.confirmPassword){s({title:"Error",description:"Passwords do not match",variant:"destructive"});return}g(!0);try{await o.K.createUserWithPermissions({name:t.name,email:t.email,password:t.password,permissions:Object.keys(u).filter(e=>u[e])}),s({title:"Success",description:"User created successfully",variant:"default"}),e.push("/users")}catch(e){console.error(e),s({title:"Failed to create user",description:(null==e?void 0:e.message)||"Failed to create user",variant:"default"})}finally{g(!1)}};return(0,r.jsx)(n.O,{children:(0,r.jsx)(l.N,{children:(0,r.jsxs)(d.Zp,{children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"Create Sub User"}),(0,r.jsx)(d.BT,{children:"Fill out details and assign permissions for the new sub user"})]}),(0,r.jsxs)(d.Wu,{className:"space-y-6",children:[(0,r.jsx)(p,{userDetails:t,setUserDetails:c}),(0,r.jsx)(x,{permissions:u,setPermissions:m}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(f.$,{onClick:w,disabled:h,children:h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create User"})})]})]})})})}},3580:(e,s,t)=>{"use strict";t.d(s,{dj:()=>m});var r=t(2115);let a=0,i=new Map,l=e=>{if(i.has(e))return;let s=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,s)},n=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},o=[],d={toasts:[]};function c(e){d=n(d,e),o.forEach(e=>{e(d)})}function u(e){let{...s}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,s]=r.useState(d);return r.useEffect(()=>(o.push(s),()=>{let e=o.indexOf(s);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9457:(e,s,t)=>{Promise.resolve().then(t.bind(t,3495))},9852:(e,s,t)=>{"use strict";t.d(s,{p:()=>l});var r=t(5155),a=t(2115),i=t(3999);let l=a.forwardRef((e,s)=>{let{className:t,type:a,...l}=e;return(0,r.jsx)("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...l})});l.displayName="Input"}},e=>{var s=s=>e(e.s=s);e.O(0,[352,244,651,73,145,258,279,441,684,358],()=>s(9457)),_N_E=e.O()}]);