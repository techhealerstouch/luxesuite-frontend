(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{2714:(e,s,a)=>{"use strict";a.d(s,{J:()=>o});var t=a(5155),n=a(2115),i=a(968),l=a(2085),r=a(3999);let c=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(i.b,{ref:s,className:(0,r.cn)(c(),a),...n})});o.displayName=i.b.displayName},6940:(e,s,a)=>{Promise.resolve().then(a.bind(a,9480))},9480:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>el});var t=a(5155),n=a(2115),i=a(6639),l=a(5499),r=a(1154),c=a(3667),o=a(8054),d=a(3580),m=a(1007),u=a(1586),p=a(381),x=a(8136),h=a(8482),f=a(7168);function g(e){var s;let{activeSection:a,setActiveSection:n,user:i}=e,l=[{id:"account",label:"Account Information",icon:m.A},{id:"subscription",label:"Subscription",icon:u.A},{id:"settings",label:"Settings",icon:p.A}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.Zp,{children:[(0,t.jsx)(h.aR,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(m.A,{className:"h-6 w-6 text-primary-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.ZB,{className:"text-lg",children:null==i?void 0:i.name}),(0,t.jsx)(h.BT,{children:null==i?void 0:i.email})]})]})}),(0,t.jsx)(h.Wu,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm",children:null==i?void 0:null===(s=i.account)||void 0===s?void 0:s.name})]})})]}),(0,t.jsx)(h.Zp,{children:(0,t.jsx)(h.Wu,{className:"p-0",children:(0,t.jsx)("nav",{className:"space-y-1",children:l.map(e=>{let{id:s,label:i,icon:l}=e,r=a===s;return(0,t.jsxs)(f.$,{onClick:()=>n(s),className:"\n                    w-full justify-start\n                    rounded-md\n                    transition-colors\n".concat(r?"bg-[hsl(var(--secondary))] text-white hover:bg-[hsl(var(--secondary))]":"bg-transparent text-[hsl(var(--white))] hover:bg-[hsl(var(--secondary))] hover:text-white","\n\n\n                  "),children:[(0,t.jsx)(l,{className:"mr-2 h-4 w-4 ".concat(r?"text-white":"text-[hsl(var(--primary))] group-hover:text-white")}),i]},s)})})})})]})}var j=a(9852),v=a(2714),y=a(81),b=a(5196),N=a(4229),w=a(547),S=a(3999);let P=w.bL,C=w.l9,E=n.forwardRef((e,s)=>{let{className:a,align:n="center",sideOffset:i=4,...l}=e;return(0,t.jsx)(w.ZL,{children:(0,t.jsx)(w.UC,{ref:s,align:n,sideOffset:i,className:(0,S.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});E.displayName=w.UC.displayName;var k=a(7740),z=a(7924),F=a(9840);let A=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(k.uB,{ref:s,className:(0,S.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...n})});A.displayName=k.uB.displayName;let D=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,t.jsx)(z.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,t.jsx)(k.uB.Input,{ref:s,className:(0,S.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...n})]})});D.displayName=k.uB.Input.displayName,n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(k.uB.List,{ref:s,className:(0,S.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...n})}).displayName=k.uB.List.displayName;let _=n.forwardRef((e,s)=>(0,t.jsx)(k.uB.Empty,{ref:s,className:"py-6 text-center text-sm",...e}));_.displayName=k.uB.Empty.displayName;let B=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(k.uB.Group,{ref:s,className:(0,S.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...n})});B.displayName=k.uB.Group.displayName,n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(k.uB.Separator,{ref:s,className:(0,S.cn)("-mx-1 h-px bg-border",a),...n})}).displayName=k.uB.Separator.displayName;let R=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(k.uB.Item,{ref:s,className:(0,S.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...n})});R.displayName=k.uB.Item.displayName;var L=a(7031),U=a(7270),I=a(7133);let M=["PHP","USD","EUR"];function Z(e){var s,a;let{formData:i,setFormData:l,onSubmit:c,isSaving:d}=e,[m,u]=(0,n.useState)([]),[p,x]=(0,n.useState)(!1),[g,w]=(0,n.useState)(""),[k,z]=(0,n.useState)(!1),{currency:F,setCurrency:Z}=(0,U.H)();(0,n.useEffect)(()=>{(async function(){try{let e=await o.K.getTimezones();u(e),z(!0)}catch(e){console.error("Failed to fetch timezones:",e),z(!0)}})()},[]),(0,n.useEffect)(()=>{if(k&&m.length>0&&!i.timezone){let e=Intl.DateTimeFormat().resolvedOptions().timeZone,s=m.find(s=>s.value===e)?e:m[0].value;l(e=>({...e,timezone:s}))}},[k,m,i.timezone,l]),(0,n.useEffect)(()=>{if(!i.timezone)return;let e=()=>{try{let e=new Date,s=(0,L.L_)(e,i.timezone),a=(0,L.GP)(s,"MMMM d, yyyy"),t=(0,L.GP)(s,"hh:mm a"),n=s.getTimezoneOffset(),l=Math.floor(Math.abs(n)/60),r=Math.abs(n)%60,c="GMT".concat(n<=0?"+":"-").concat(l).concat(r>0?":".concat(r.toString().padStart(2,"0")):"");w("".concat(a," ").concat(t," ").concat(i.timezone," ").concat(c))}catch(e){console.error("Error formatting time:",e),w("Invalid timezone")}};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[i.timezone]);let $=null!==(a=null===(s=m.find(e=>e.value===i.timezone))||void 0===s?void 0:s.label)&&void 0!==a?a:"Select timezone",T=e=>{let{id:s,value:a}=e.target;"businessName"===s||"slug"===s?l(e=>({...e,account:{...e.account,["businessName"===s?"name":"slug"]:a}})):l(e=>({...e,[s]:a}))},G=e=>{l(s=>({...s,timezone:e})),x(!1)};return(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{children:[(0,t.jsx)(h.ZB,{children:"Account Information"}),(0,t.jsx)(h.BT,{children:"Manage your personal and business details"})]}),(0,t.jsx)(h.Wu,{children:(0,t.jsxs)("form",{onSubmit:c,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.J,{htmlFor:"name",children:"Full Name"}),(0,t.jsx)(j.p,{id:"name",type:"text",value:i.name,onChange:T})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.J,{htmlFor:"email",children:"Email"}),(0,t.jsx)(j.p,{id:"email",type:"email",value:i.email,onChange:T})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.J,{htmlFor:"businessName",children:"Business Name"}),(0,t.jsx)(j.p,{id:"businessName",type:"text",value:i.account.name,onChange:T})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.J,{htmlFor:"slug",children:"Slug"}),(0,t.jsx)(j.p,{id:"slug",type:"text",value:i.account.slug,onChange:T})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.J,{htmlFor:"phone_number",children:"Phone Number"}),(0,t.jsx)(j.p,{id:"phone_number",type:"tel",value:i.phone_number||"",onChange:T,placeholder:"Enter your phone number"})]}),(0,t.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,t.jsx)(v.J,{htmlFor:"timezone",children:"Timezone"}),(0,t.jsxs)(P,{open:p,onOpenChange:x,children:[(0,t.jsx)(C,{asChild:!0,children:(0,t.jsx)(f.$,{variant:"outline",role:"combobox","aria-expanded":p,className:"w-full justify-between",disabled:!k,children:k?(0,t.jsxs)(t.Fragment,{children:[$,(0,t.jsx)(y.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading timezones..."]})})}),(0,t.jsx)(E,{className:"w-[var(--radix-popover-trigger-width)] max-h-60 overflow-y-auto p-0",align:"start",children:(0,t.jsxs)(A,{children:[(0,t.jsx)(D,{placeholder:"Search timezone..."}),(0,t.jsx)(_,{children:"No timezone found."}),(0,t.jsx)(B,{children:m.map(e=>(0,t.jsxs)(R,{onSelect:()=>G(e.value),className:(0,S.cn)(i.timezone===e.value?"bg-blue-100 font-semibold":""),children:[(0,t.jsx)(b.A,{className:(0,S.cn)("mr-2 h-4 w-4",i.timezone===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})})]}),g&&(0,t.jsxs)("div",{className:"mt-2 p-2 bg-gray-100 border border-gray-200 text-gray-800 rounded text-sm font-mono",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Current time: "}),g]})]})]}),(0,t.jsx)("div",{className:"mr-4",children:(0,t.jsxs)(I.rI,{children:[(0,t.jsx)(I.ty,{asChild:!0,children:(0,t.jsx)(f.$,{variant:"outline",children:F})}),(0,t.jsx)(I.SQ,{align:"end",forceMount:!0,children:M.map(e=>(0,t.jsx)(I._2,{onClick:()=>Z(e),children:e},e))})]})}),(0,t.jsxs)(f.$,{type:"submit",disabled:d,children:[d?(0,t.jsx)(r.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,t.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})})]})}var $=a(8145),T=a(8933),G=a(7108),K=a(1930),H=a(599);function J(e){let{subscription:s,getStatusColor:a,onUpgrade:i,onCancel:l,billingHistory:r}=e,[c,d]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),p=async()=>{d(!0);try{let e=await o.K.cancelSubscription(s.id.toString());console.log("Cancel response:",e),window.location.reload(),u(!1)}catch(e){console.error("Failed to cancel subscription:",e)}finally{d(!1)}};return r.find(e=>"SCHEDULED"===e.status),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Zp,{children:(0,t.jsx)(h.Wu,{className:"p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(G.A,{className:"text-primary size-5"}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"free-trial"===s.payment_url?"Free Trial":"".concat(s.plan.name," | ").concat(s.plan.domain)}),(0,t.jsx)($.E,{variant:a(s.status),children:s.status})]}),(0,t.jsxs)("p",{className:"text-muted-foreground mt-1 text-sm",children:[(0,t.jsx)(K.S,{amount:Number(s.plan.price.replace(/[^\d.-]/g,"")),from:"PHP"}),"/month • Access to Luxe Proof ends on"," ",s.end_date?(0,H.GP)(new Date(s.end_date),"MMM dd, yyyy"):""]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:["pending"===s.status&&(0,t.jsx)(f.$,{variant:"default",className:"w-full sm:w-auto",onClick:()=>{s.payment_url&&(window.location.href=s.payment_url)},children:"Pay Now"}),"pending"!==s.status&&"cancelled"!==s.status&&"free-trial"!==s.payment_url&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.$,{variant:"default",className:"w-full sm:w-auto",onClick:i,children:"Upgrade Plan"}),(0,t.jsx)(f.$,{variant:"outline",className:"w-full sm:w-auto",onClick:()=>u(!0),children:"Deactivate Plan"})]})]})]})})}),(0,t.jsx)(F.lG,{open:m,onOpenChange:u,children:(0,t.jsxs)(F.Cf,{children:[(0,t.jsx)(F.c7,{children:(0,t.jsx)(F.L3,{children:"Cancel Subscription"})}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Are you sure you want to cancel your subscription? This action cannot be undone. Remaining paid months/cycles will be refunded to the payment method you've linked."}),(0,t.jsxs)(F.Es,{className:"mt-4",children:[(0,t.jsx)(f.$,{variant:"outline",onClick:()=>u(!1),disabled:c,children:"No, Keep Plan"}),(0,t.jsx)(f.$,{variant:"destructive",onClick:p,disabled:c,children:c?"Cancelling...":"Yes, Cancel"})]})]})})]})}var O=a(3904),W=a(1788),V=a(7434);let Y={PENDING:"bg-yellow-100 text-yellow-800",RETRYING:"bg-red-100 text-red-800",FAILED:"bg-red-100 text-red-800",SUCCEEDED:"bg-green-100 text-green-800",SCHEDULED:"bg-gray-100 text-gray-800"},q={SUCCEEDED:"Paid",SCHEDULED:"Upcoming",PENDING:"Pending",RETRYING:"Retrying",FAILED:"Failed"};function Q(e){let{invoices:s,isLoading:a,onPaymentSuccess:n,onRefresh:i}=e,{toast:l}=(0,d.dj)(),r=async(e,s)=>{try{let a=await o.K.forceAttempt(e,s);console.log("Advance payment result:",a),a?(l({title:"Payment Success",description:"Payment attempted successfully!"}),null==n||n()):l({title:"Payment Failed",description:"Failed to attempt payment.",variant:"destructive"})}catch(e){console.error(e),l({title:"Error",description:"Something went wrong.",variant:"destructive"})}};return(0,t.jsx)(h.Zp,{children:(0,t.jsxs)(h.Wu,{className:"p-4 sm:p-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Billing Cycle"}),(0,t.jsx)(f.$,{variant:"ghost",size:"icon",onClick:i,disabled:a,children:(0,t.jsx)(O.A,{className:"size-4"})})]}),(0,t.jsxs)(f.$,{variant:"outline",size:"sm",disabled:a,children:[(0,t.jsx)(W.A,{className:"mr-2 size-4"}),"Download All"]})]}),a?(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"Loading invoices..."}):0===s.length?(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"No billing history found."}):(0,t.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 border-b py-3 last:border-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-muted rounded-md p-2",children:(0,t.jsx)(V.A,{className:"text-muted-foreground size-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:[e.id.slice(0,18),"..."]}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:e.date})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-sm font-medium ".concat(Y[e.status]||"bg-gray-100 text-gray-800"),children:q[e.status]||e.status}),(0,t.jsx)(K.S,{amount:Number(e.amount.replace(/[^\d.-]/g,"")),from:"PHP"}),"SUCCEEDED"!==e.status&&"CANCELLED"!==e.status&&"REFUNDED"!==e.status&&(0,t.jsxs)(f.$,{variant:"default",size:"sm",onClick:()=>r(e.plan_id,e.id),children:[(0,t.jsx)(u.A,{className:"mr-1 size-4"}),"Pay Now"]})]})]},e.id))})]})})}var X=a(6699);function ee(e){let{subscription:s,availablePlans:a,onBack:i}=e,{toast:l}=(0,d.dj)(),[r,c]=(0,n.useState)("1"),[m,u]=(0,n.useState)(!1),p=(e,s)=>e*s,x=async e=>{try{u(!0),await o.K.upgradeSubscription(s.id.toString(),e.id,parseInt(r)),l({title:"Plan upgraded",description:"You've successfully upgraded to the ".concat(e.name," plan for ").concat(r," month(s).")})}catch(e){l({title:"Upgrade failed",description:"Something went wrong upgrading your plan.",variant:"destructive"})}finally{u(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(f.$,{variant:"ghost",onClick:i,children:"← Back to Subscription Details"}),(0,t.jsx)("div",{className:"mb-6 flex flex-wrap justify-center gap-2 sm:gap-3",children:["1","3","6","12"].map(e=>(0,t.jsx)("button",{className:"px-4 py-2 rounded-md font-semibold text-sm ".concat(r===e?"bg-primary text-white":"bg-muted text-muted-foreground"),onClick:()=>c(e),children:"1"===e?"Monthly":"".concat(e," Months")},e))}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:a.map(e=>{var a,n;let i=p(e.price,parseInt(r)),l=e.name===s.plan.name;return(0,t.jsxs)(h.Zp,{className:"flex flex-col",children:[(0,t.jsxs)(h.aR,{className:"text-center pb-2",children:["Professional"===e.name&&(0,t.jsx)(X.A,{className:"uppercase w-max self-center mb-3",children:"Most popular"}),(0,t.jsx)(h.ZB,{className:"mb-7",children:e.name}),(0,t.jsxs)("span",{className:"font-bold text-2xl sm:text-3xl",children:["₱",i.toFixed(2)]})]}),(0,t.jsx)(h.BT,{className:"text-center w-11/12 mx-auto mb-4 text-sm",children:null!==(n=null===(a=e.features)||void 0===a?void 0:a[0])&&void 0!==n?n:"Flexible features"}),(0,t.jsx)(h.Wu,{className:"flex-1",children:(0,t.jsx)("ul",{className:"mt-7 space-y-2.5 text-sm",children:e.features.map((e,s)=>(0,t.jsxs)("li",{className:"flex space-x-2",children:[(0,t.jsx)(b.A,{className:"flex-shrink-0 mt-0.5 h-4 w-4"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:e})]},s))})}),(0,t.jsx)(h.wL,{children:l?(0,t.jsx)(f.$,{className:"w-full",disabled:!0,children:"Current Plan"}):(0,t.jsx)(f.$,{className:"w-full",variant:"Professional"===e.name?void 0:"ghost",onClick:()=>x(e),disabled:m,children:m?"Upgrading...":"Subscribe"})})]},e.id)})})]})}function es(e){let{open:s,onOpenChange:a,subscription:i,getStatusColor:l}=e,{toast:r}=(0,d.dj)(),[c,m]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[x,h]=(0,n.useState)([]),[f,g]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=async()=>{if(i)try{g(!0);let e=(await o.K.getSubscriptionPlans()).data.filter(e=>e.domain===i.plan.domain&&"base"!==e.slug).map(e=>({...e,price:parseFloat(e.price),features:["Sub-user limit: ".concat(e.sub_user_limit),"Product limit: ".concat(e.product_limit)]}));h(e)}catch(e){r({title:"Failed to load plans",description:"Unable to fetch subscription plans.",variant:"destructive"})}finally{g(!1)}};s&&i&&e()},[s,i,r]);let[j,v]=(0,n.useState)([]),[y,b]=(0,n.useState)(!1),N=async()=>{if(i)try{b(!0);let e=await o.K.getBillingHistory(i.id.toString());console.log("Data getBillingHistory",e),v(e)}catch(e){r({title:"Failed to load billing history",description:"Unable to fetch invoices.",variant:"destructive"})}finally{b(!1)}};return(0,n.useEffect)(()=>{s&&i&&N()},[s,i]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(F.lG,{open:s,onOpenChange:a,children:(0,t.jsxs)(F.Cf,{className:"max-w-full sm:max-w-4xl p-4 sm:p-6 max-h-[80vh] overflow-y-auto",children:[(0,t.jsx)(F.c7,{children:(0,t.jsx)(F.L3,{children:"Subscription Details"})}),i&&!u&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(J,{subscription:i,getStatusColor:l,billingHistory:j,onUpgrade:()=>{"free-trial"!==i.payment_url&&p(!0)},onCancel:()=>{"free-trial"!==i.payment_url&&m(!0)}}),"free-trial"!==i.payment_url&&(0,t.jsx)(Q,{invoices:j,isLoading:y,onPaymentSuccess:N})]}),i&&u&&(0,t.jsx)(ee,{subscription:i,availablePlans:x,onBack:()=>p(!1)})]})})})}function ea(e){let{subscriptions:s,isLoading:a}=e,[i,l]=(0,n.useState)(null),[r,c]=(0,n.useState)(!1);if(a)return(0,t.jsx)(h.Zp,{children:(0,t.jsx)(h.Wu,{className:"flex items-center justify-center py-12",children:"Loading..."})});let o=e=>{l(e),c(!0)},d=e=>{switch(e){case"active":return"default";case"pending":default:return"secondary";case"suspended":return"destructive";case"cancelled":return"outline"}};return(0,t.jsxs)(h.Zp,{children:[(0,t.jsx)(h.aR,{children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between w-full gap-4 sm:gap-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.ZB,{children:"Subscription Details"}),(0,t.jsx)(h.BT,{children:"Manage your subscription and billing information"})]}),(0,t.jsx)(T.u,{onSelectPlan:(e,s)=>{console.log("User selected plan:",e,"for months:",s)}})]})}),(0,t.jsx)(es,{open:r,onOpenChange:c,subscription:i,getStatusColor:d}),(0,t.jsx)(h.Wu,{className:"space-y-6",children:s&&s.length>0?(0,t.jsx)(t.Fragment,{children:s.map(e=>{var s,a;return(0,t.jsxs)("div",{onClick:()=>o(e),tabIndex:0,role:"button",onKeyDown:s=>{("Enter"===s.key||" "===s.key)&&o(e)},className:"border rounded-lg p-4 space-y-4 cursor-pointer hover:shadow-md transition focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-base sm:text-lg",children:"free-trial"===e.payment_url?"Free Trial | ".concat(e.service):"".concat(null!==(a=null===(s=e.plan)||void 0===s?void 0:s.name)&&void 0!==a?a:"No plan available"," | ").concat(e.service)}),(0,t.jsx)($.E,{variant:d(e.status),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),e.features&&e.features.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-sm mb-1",children:"Features Included:"}),(0,t.jsx)("ul",{className:"space-y-1 text-sm",children:e.features.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),e]},s))})]})]},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"No active subscription found"}),(0,t.jsx)(f.$,{className:"w-full sm:w-auto",children:"Choose a Plan"})]})})]})}var et=a(4884);let en=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(et.bL,{className:(0,S.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:s,children:(0,t.jsx)(et.zi,{className:(0,S.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});function ei(e){let{passwordData:s,setPasswordData:a,onPasswordSubmit:n,isSaving:i,accountSettings:l,onSettingsUpdate:c}=e;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{children:[(0,t.jsx)(h.ZB,{children:"Change Password"}),(0,t.jsx)(h.BT,{children:"Update your account password"})]}),(0,t.jsx)(h.Wu,{children:(0,t.jsxs)("form",{onSubmit:n,className:"space-y-4",children:[[{id:"currentPassword",label:"Current Password"},{id:"newPassword",label:"New Password"},{id:"confirmPassword",label:"Confirm New Password"}].map(e=>{let{id:n,label:i}=e;return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.J,{htmlFor:n,children:i}),(0,t.jsx)(j.p,{id:n,type:"password",value:s[n],onChange:e=>a(s=>({...s,[n]:e.target.value}))})]},n)}),(0,t.jsxs)(f.$,{type:"submit",disabled:i,children:[i?(0,t.jsx)(r.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,t.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Update Password"]})]})})]}),l&&(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{children:[(0,t.jsx)(h.ZB,{children:"Preferences"}),(0,t.jsx)(h.BT,{children:"Manage your account preferences"})]}),(0,t.jsxs)(h.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Notifications"}),["email","sms"].map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(v.J,{htmlFor:"".concat(e,"-notifications"),children:"".concat(e.toUpperCase()," notifications")}),(0,t.jsx)(en,{id:"".concat(e,"-notifications"),checked:l.notifications[e],onCheckedChange:s=>c({notifications:{...l.notifications,[e]:s}})})]},e))]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Privacy"}),[{id:"profileVisible",label:"Profile visible to others"},{id:"analyticsEnabled",label:"Enable analytics tracking"}].map(e=>{let{id:s,label:a}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(v.J,{htmlFor:s,children:a}),(0,t.jsx)(en,{id:s,checked:l.privacy[s],onCheckedChange:e=>c({privacy:{...l.privacy,[s]:e}})})]},s)})]})]})]})]})}function el(){let[e,s]=(0,n.useState)("account"),[a,m]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[x,h]=(0,n.useState)([]),[f,j]=(0,n.useState)(null),[v,y]=(0,n.useState)(!1),{currency:b,setCurrency:N}=(0,U.H)(),{user:w}=(0,c.A)(),{toast:S}=(0,d.dj)(),[P,C]=(0,n.useState)({id:null,name:"",email:"",phone_number:"",timezone:"",account:{name:"",slug:""}}),[E,k]=(0,n.useState)({currentPassword:"",newPassword:"",confirmPassword:""});async function z(){m(!0);try{let e=await o.K.getSubscriptions();h(e.data)}catch(e){}finally{m(!1)}}async function F(e){if(e.preventDefault(),!P.name.trim()||!P.email.trim()){S({title:"Validation Error",description:"Name and email are required",variant:"destructive"});return}p(!0);try{await o.K.updateAccount(P),S({title:"Success",description:"Account information updated successfully"})}catch(a){console.error("Failed to update account:",a);let e="Failed to update account information";if("object"==typeof a&&null!==a){if("data"in a&&"object"==typeof a.data&&null!==a.data){var s;e=null!==(s=a.data.message)&&void 0!==s?s:e}else"message"in a&&"string"==typeof a.message&&(e=a.message)}S({title:"Error",description:e,variant:"destructive"})}finally{p(!1)}}async function A(e){if(e.preventDefault(),!E.currentPassword||!E.newPassword){S({title:"Validation Error",description:"Both current and new passwords are required",variant:"destructive"});return}if(E.newPassword!==E.confirmPassword){S({title:"Validation Error",description:"New passwords do not match",variant:"destructive"});return}if(E.newPassword.length<6){S({title:"Validation Error",description:"New password must be at least 6 characters long",variant:"destructive"});return}p(!0);try{await o.K.changePassword({currentPassword:E.currentPassword,newPassword:E.newPassword}),S({title:"Success",description:"Password updated successfully"}),k({currentPassword:"",newPassword:"",confirmPassword:""})}catch(a){let e="Failed to update password";if("object"==typeof a&&null!==a){if("data"in a&&"object"==typeof a.data&&null!==a.data){var s;e=null!==(s=a.data.message)&&void 0!==s?s:e}else"message"in a&&"string"==typeof a.message&&(e=a.message)}S({title:"Error",description:e,variant:"destructive"})}finally{p(!1)}}async function D(e){if(f){p(!0);try{let s=await o.K.updateSettings({...f,...e});j(s),S({title:"Success",description:"Settings updated successfully"})}catch(a){console.error("Failed to update settings:",a);let e="Failed to update settings";if("object"==typeof a&&null!==a){if("data"in a&&"object"==typeof a.data&&null!==a.data){var s;e=null!==(s=a.data.message)&&void 0!==s?s:e}else"message"in a&&"string"==typeof a.message&&(e=a.message)}S({title:"Error",description:e,variant:"destructive"})}finally{p(!1)}}}return(0,n.useEffect)(()=>{if(w){if(v)w.timezone&&!P.timezone&&C(e=>({...e,timezone:w.timezone||""}));else{var e,s,a;C({id:(null===(e=w.account)||void 0===e?void 0:e.id)||null,name:w.name||"",email:w.email||"",phone_number:w.phone_number||"",timezone:w.timezone||"",account:{name:(null===(s=w.account)||void 0===s?void 0:s.name)||"",slug:(null===(a=w.account)||void 0===a?void 0:a.slug)||""}}),y(!0)}}},[w,v,P.timezone]),(0,n.useEffect)(()=>{"subscription"===e&&z()},[e]),(0,t.jsx)(i.O,{children:(0,t.jsx)(l.N,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Account"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage your account settings and preferences."})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,t.jsx)("div",{className:"w-full md:w-2/5 space-y-4 px-4 md:px-0",children:(0,t.jsx)(g,{activeSection:e,setActiveSection:s,user:w})}),(0,t.jsxs)("div",{className:"w-full md:w-3/5 px-4 md:px-0",children:[a&&(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,t.jsx)(r.A,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2 text-muted-foreground",children:"Loading..."})]}),!a&&"account"===e&&(0,t.jsx)(Z,{formData:P,setFormData:C,onSubmit:F,isSaving:u}),!a&&"subscription"===e&&(0,t.jsx)(ea,{subscriptions:x,isLoading:a}),!a&&"settings"===e&&(0,t.jsx)(ei,{passwordData:E,setPasswordData:k,onPasswordSubmit:A,isSaving:u,accountSettings:f,onSettingsUpdate:D})]})]})]})})})}en.displayName=et.bL.displayName},9852:(e,s,a)=>{"use strict";a.d(s,{p:()=>l});var t=a(5155),n=a(2115),i=a(3999);let l=n.forwardRef((e,s)=>{let{className:a,type:n,...l}=e;return(0,t.jsx)("input",{type:n,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});l.displayName="Input"}},e=>{var s=s=>e(e.s=s);e.O(0,[352,244,651,73,145,386,567,528,279,933,441,684,358],()=>s(6940)),_N_E=e.O()}]);